{"version":3,"sources":["js/Http.js","js/index.js"],"names":["Http","constructor","uri","serialize","obj","qs","prop","encodeURIComponent","join","errorHandler","res","ok","Error","error","get","path","fetch","then","post","data","req","Request","method","body","headers","delete","id","_default","exports","default","_Http","_interopRequireDefault","require","__esModule","container","document","querySelector","total","addProductForm","http","Row","product","price","render","arr","elems","map","e","totalCost","reduce","prev","curr","Number","innerHTML","loadAndRender","response","json","alert","addEventListener","preventDefault","target","elements","console","log","value","JSON","stringify","getAttribute"],"mappings":"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","file":"js.00a46daa.js","sourceRoot":"..\\src","sourcesContent":["class Http {\r\n  constructor(uri) {\r\n    this.uri = uri;\r\n  }\r\n  static serialize(obj) {\r\n    let qs = [];\r\n    for (let prop in obj) {\r\n      qs = [\r\n        ...qs,\r\n        `${encodeURIComponent(prop)}=${encodeURIComponent(obj[prop])}`,\r\n      ];\r\n    }\r\n\r\n    return qs.join(\"&\");\r\n  }\r\n  static errorHandler(res) {\r\n    if (!res.ok) throw new Error(res.error);\r\n    return res;\r\n  }\r\n  get(path = \"\", qs) {\r\n    return fetch(`${this.uri}${path}/?${Http.serialize(qs)}`).then(\r\n      Http.errorHandler\r\n    );\r\n  }\r\n  post(path = \"\", data) {\r\n    const req = new Request(`${this.uri}${path}`, {\r\n      method: \"POST\",\r\n      body: data,\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    });\r\n\r\n    return fetch(req).then(Http.errorHandler);\r\n  }\r\n  delete(path = \"\", id) {\r\n    const req = new Request(`${this.uri}${path}/${id}`, { method: \"DELETE\" });\r\n    return fetch(req).then(Http.errorHandler);\r\n  }\r\n}\r\n\r\nexport default Http;\r\n","import Http from \"./Http\";\nconst container = document.querySelector(\".list\");\nconst total = document.querySelector(\".total\");\nconst addProductForm = document.querySelector(\"form[name=add-product]\");\nconst http = new Http(\"http://localhost:3000/products\");\n\nconst Row = ({ product, price, id }) =>\n  `<div class=\"product\">\n    <span class=\"prod-name\">${product}</span>\n    <span class=\"prod-cost\">$${price}</span>\n    <div class=\"delete-btn\"><a href=\"#\" name=\"delete-btn\" data-id=\"${id}\">X</a></div>\n  </div>`;\n\nconst render = function (arr) {\n  const elems = arr.map((e) => Row(e));\n  const totalCost = arr.reduce((prev, curr) => prev + Number(curr.price), 0);\n\n  container.innerHTML = elems.join(\"\");\n  total.innerHTML = Row({ product: \"TOTAL\", price: totalCost });\n};\n\n// const getData = (uri) =>\n//   new Promise((resolve, reject) => {\n//     const xhr = new XMLHttpRequest();\n//     xhr.addEventListener(\"load\", function () {\n//       resolve(JSON.parse(this.response));\n//     });\n//     xhr.addEventListener(\"error\", () => reject());\n//     xhr.open(\"GET\", uri);\n//     xhr.send();\n//   });\n\nasync function loadAndRender() {\n  try {\n    const response = await http.get();\n    const json = await response.json();\n    render(json);\n  } catch {\n    alert(\"There was an error talking to the server!\");\n  }\n}\n\nloadAndRender();\n\n//add product and reload\naddProductForm.addEventListener(\"submit\", async function (e) {\n  e.preventDefault();\n  let product = e.target.elements.product;\n  let price = e.target.elements.price;\n  console.log(product.value, price.value);\n  try {\n    if (product.value !== \"\" && price.value !== 0) {\n      await http.post(\n        \"/\",\n        JSON.stringify({ product: product.value, price: Number(price.value) })\n      );\n      loadAndRender();\n    }\n  } catch (error) {\n    alert(`There was an error storing data: ${error}`);\n  } finally {\n    product.value = \"\";\n    price.value = \"\";\n  }\n});\n\ncontainer.addEventListener(\"click\", async function (e) {\n  e.preventDefault();\n  if (e.target.getAttribute(\"name\") === \"delete-btn\") {\n    let id = e.target.getAttribute(\"data-id\");\n    try {\n      await http.delete(\"/\", id);\n      loadAndRender();\n    } catch (error) {\n      alert(`Error in deleting the product:${error} `);\n    }\n  }\n});\n"]}